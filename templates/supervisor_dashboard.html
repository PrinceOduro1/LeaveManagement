{% extends 'base.html' %}
{% block title %}Supervisor Dashboard{% endblock %}
{% block content %}
<h4>Pending Requests (Your Department)</h4>
<table class="table table-bordered table-sm">
  <thead class="thead-light">
    <tr>
      <th>Employee</th>
      <th>Start Date</th>
      <th>End Date</th>
      <th>Reason</th>
      <th>Status</th>
      <th>Comment</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    {% for leave in requests %}
      <tr>
        <td>{{ leave.employee.user.get_full_name }}</td>
        <td>{{ leave.start_date }}</td>
        <td>{{ leave.end_date }}</td>
        <td>{{ leave.reason }}</td>
        <td>{{ leave.status }}</td>
        <td>
          <form method="post" action="{% url 'supervisor_approve' leave.id %}">
            {% csrf_token %}
            <input type="text" name="comment" class="form-control form-control-sm" placeholder="Add comment..." required>
        </td>
        <td>
          <form method="post" action="{% url 'supervisor_approve' leave.id %}">
            {% csrf_token %}
            <button name="action" value="approve" class="btn btn-success btn-sm">Approve</button>
            <button name="action" value="reject" class="btn btn-danger btn-sm">Reject</button>
          </form>
        </td>
      </tr>
    {% empty %}
      <tr><td colspan="6">No pending requests.</td></tr>
    {% endfor %}
  </tbody>
</table>

<hr>

<h4>All Leave Requests (All Employees)</h4>
<table class="table table-bordered table-sm">
  <thead class="thead-light">
    <tr>
      <th>Employee</th>
      <th>Department</th>
      <th>Date Requested</th>
      <th>Start Date</th>
      <th>End Date</th>
      <th>Status</th>
      <th>Supervisor</th>
    </tr>
  </thead>
  <tbody>
    {% for leave in all_requests %}
      <tr>
        <td>{{ leave.employee.user.get_full_name }}</td>
        <td>{{ leave.employee.department }}</td>
        <td>{{ leave.date_requested }}</td>
        <td>{{ leave.start_date }}</td>
        <td>{{ leave.end_date }}</td>
        <td>{{ leave.status }}</td>
        <td>{{ leave.supervisor.user.get_full_name }}</td>
      </tr>
    {% empty %}
      <tr><td colspan="6">No leave requests yet.</td></tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
